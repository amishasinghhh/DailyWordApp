<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
    /**
     * Sample JavaScript code for sheets.spreadsheets.values.get
     * See instructions for running APIs Explorer code samples locally:
     * https://developers.google.com/explorer-help/code-samples#javascript
     */
    function loadClient() {
        gapi.client.setApiKey("AIzaSyA7yuO-d3GkigRjUD4v8ZU7cjeVIuk-Rns");
        return gapi.client.load("https://sheets.googleapis.com/$discovery/rest?version=v4")
            .then(function() { console.log("GAPI client loaded for API"); },
                function(err) { console.error("Error loading GAPI client for API", err); });
    }
    function sp_execute() {
        if (localStorage.getItem('sp_word') != null) {
            window.location = "sp-flashcard.html";
            return;
        }
        num = Math.floor(Math.random() * 4699)
        return gapi.client.sheets.spreadsheets.values.get({
        "spreadsheetId": "1S2ZlZ5GDNzsVigoec0a4i9tYyZiW83SajYAZNR_0ZCU",
        "range": "A" + num + ":D" + num,
        "dateTimeRenderOption": "SERIAL_NUMBER",
        "majorDimension": "ROWS",
        "valueRenderOption": "FORMATTED_VALUE"
        })
            .then(function(response) {
                localStorage.setItem('sp_word', response.result["values"][0][0]);
                localStorage.setItem('sp_pos', response.result["values"][0][1]);
                localStorage.setItem('sp_definition', response.result["values"][0][2]);
                localStorage.setItem('sp_sentence', response.result["values"][0][3]);
                window.location = "sp-flashcard.html";
            },
                function(err) { console.error("Execute error", err); });
    }
    // Make sure the client is loaded and sign-in is complete before calling this method.
    function execute() {
        num = Math.floor(Math.random() * 1475)
        return gapi.client.sheets.spreadsheets.values.get({
        "spreadsheetId": "1CzxWzQrFb7bGbDWWLj_v7kWySEBGcS4NZkApCZxyBtM",
        "range": "A" + num + ":D" + num,
        "dateTimeRenderOption": "SERIAL_NUMBER",
        "majorDimension": "ROWS",
        "valueRenderOption": "FORMATTED_VALUE"
        })
            .then(function(response) {
                console.log(response.result["values"][0][0])
                localStorage.setItem('kr_word', response.result["values"][0][0]);
                document.getElementById("word").innerHTML = response.result["values"][0][0];
                localStorage.setItem('kr_pos', response.result["values"][0][1]);
                document.getElementById("partOfSpeech").innerHTML = response.result["values"][0][1];
                localStorage.setItem('kr_definition', response.result["values"][0][2]);
                document.getElementById("definition").innerHTML = response.result["values"][0][2];
                localStorage.setItem('kr_sentence', response.result["values"][0][3]);
                document.getElementById("sentence").innerHTML = response.result["values"][0][3];
                },
                function(err) { console.error("Execute error", err); });
    }
    gapi.load("client:auth2", function() {
        gapi.auth2.init({client_id: "301275820345-5972hb0n3ci0ndiuhsk50vj0p6qhn4cl.apps.googleusercontent.com", discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],});
    });
    window.onload = function() {
        document.getElementById("word").innerHTML = localStorage.getItem('kr_word');
        document.getElementById("partOfSpeech").innerHTML = localStorage.getItem('kr_pos');
        document.getElementById("definition").innerHTML = localStorage.getItem('kr_definition');
        document.getElementById("sentence").innerHTML = localStorage.getItem('kr_sentence');
    };
    </script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homepage</title>
    <link rel="stylesheet" href="kr-flashcard.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@800&display=swap');
    </style>
</head>
<body>
    <div class = "tabs">
        <span style="color:#6474E5">...</h2>
        <span style ="color:#FFFFFF"> 한국어 </a> </span>
        <span style ="color:#F8C8C6"> | </span>
        <span style ="color:#9AA4EC" onclick = loadClient().then(sp_execute)> <a> español</a></span>
    </div>
    <div style="color:#6474E5">...</div>
    <div style="color:#6474E5">...</div>
    <div style="color:#6474E5">...</div>
    <div class = "word">
        <span align = "center" id = "word">사과</span>
    </div>
    <div class = "pos" align = "center">
        <span align = "center" id = "partOfSpeech">noun</span>
    </div>
    <div class = "def" align = "center">
        <span align = "center" id = "definition">apple</span>
    </div>
    <div class = "sentence" align = "center">
        <span align = "center" id = "sentence">매일 사과를 먹으면 건강하게 살 수 있어.</span>
    </div>
    <div>
        <img src = "images/left_arrow.png" class = "left">
        <img src = "images/right_arrow.png" class = "right" onclick="loadClient().then(execute)">
    </div>
</body>
</html>